import{G as v,u as g,a as N,r as e,R as L,b as z,c as $,L as S,d as B}from"./index.3f56f363.js";import{c as b,a as f,F as y,b as k}from"./formik.esm.a27956e7.js";import{f as F}from"./fetchBlog.8e9ac835.js";const M="_blog_ydndw_1",P="_message_ydndw_67",T="_error_ydndw_80",j="_edit_ydndw_85",I="_buttons_ydndw_103",R="_icon_ydndw_113";var h={blog:M,message:P,error:T,edit:j,buttons:I,icon:R};const A="_icon_1717r_1";var D={icon:A};function w(t){return v({tag:"svg",attr:{viewBox:"0 0 1024 1024"},child:[{tag:"path",attr:{d:"M360 184h-8c4.4 0 8-3.6 8-8v8h304v-8c0 4.4 3.6 8 8 8h-8v72h72v-80c0-35.3-28.7-64-64-64H352c-35.3 0-64 28.7-64 64v80h72v-72zm504 72H160c-17.7 0-32 14.3-32 32v32c0 4.4 3.6 8 8 8h60.4l24.7 523c1.6 34.1 29.8 61 63.9 61h454c34.2 0 62.3-26.8 63.9-61l24.7-523H888c4.4 0 8-3.6 8-8v-32c0-17.7-14.3-32-32-32zM731.3 840H292.7l-24.2-512h487l-24.2 512z"}}]})(t)}function H(t){const s=g(r=>r.user.token),l=N(),u=t.id,m=async()=>{try{const r=await fetch(`https://aryan-api.771727.xyz/blog-mania/user/${u}`,{method:"DELETE",headers:{authorization:`BEARER ${s}`}});if(l(-1),!r.ok)throw new Error("Could not delete blog page")}catch(r){console.log(r)}};return e.exports.createElement(w,{size:"30px",color:"red",className:D.icon,onClick:m})}const O="_error_1t93d_1",V="_form_1t93d_8";var _={error:O,form:V};function q(t){const[s,l]=e.exports.useState(!1),u=g(o=>o.user.token),m=async o=>{try{if(!(await fetch(`https://aryan-api.771727.xyz/blog-mania/blogs/comment/${t.blogId}`,{method:"POST",body:JSON.stringify({comment:o.comment}),headers:{"Content-Type":"application/json",authorization:`BEARER ${u}`}})).ok)throw new Error("Could not create new comment");t.toggler()}catch(n){console.log(n)}},r=b().shape({comment:f().required("Your comment is empty!")});return e.exports.createElement("section",{className:_.form},e.exports.createElement(y,{initialValues:{comment:""},validationSchema:r,validateOnChange:!1,validateOnBlur:!1,onSubmit:o=>{m(o),l(!0),setTimeout(()=>{l(!1)},3e3)}},({errors:o,handleBlur:n,handleChange:d,values:c})=>e.exports.createElement(k,null,e.exports.createElement("label",{htmlFor:"comment"}," Add a Comment"),e.exports.createElement("textarea",{name:"comment",onChange:d,onBlur:n,value:c.comment}),o.comment&&e.exports.createElement("div",{className:_.error},o.comment),e.exports.createElement("button",{className:"btn",type:"submit",disabled:s},"Comment"))))}const G="_item_ywirw_1",J="_user_ywirw_22",U="_span_ywirw_60",W="_icon_ywirw_67";var E={item:G,user:J,span:U,icon:W},Y="/myblog/assets/user-img.71898c51.png";function C(t){return v({tag:"svg",attr:{viewBox:"0 0 24 24"},child:[{tag:"path",attr:{d:"M4 21a1 1 0 0 0 .24 0l4-1a1 1 0 0 0 .47-.26L21 7.41a2 2 0 0 0 0-2.82L19.42 3a2 2 0 0 0-2.83 0L4.3 15.29a1.06 1.06 0 0 0-.27.47l-1 4A1 1 0 0 0 3.76 21 1 1 0 0 0 4 21zM18 4.41 19.59 6 18 7.59 16.42 6zM5.91 16.51 15 7.41 16.59 9l-9.1 9.1-2.11.52z"}}]})(t)}function Q(t){const[s,l]=e.exports.useState(!1),u=g(o=>o.user.token),m=async o=>{try{if(!(await fetch(`https://aryan-api.771727.xyz/blog-mania/blogs/comment/${t.commentId}`,{method:"PATCH",body:JSON.stringify({comment:o.comment}),headers:{"Content-Type":"application/json",authorization:`BEARER ${u}`}})).ok)throw new Error("Could not update comment");t.editToggle(),t.toggler()}catch(n){console.log(n)}},r=b().shape({comment:f().required("Your comment is empty!")});return e.exports.createElement("section",{className:_.form},e.exports.createElement(y,{initialValues:{comment:t.comment},validationSchema:r,validateOnChange:!1,validateOnBlur:!1,onSubmit:o=>{m(o),l(!0),setTimeout(()=>{l(!1)},3e3)}},({errors:o,handleBlur:n,handleChange:d,values:c})=>e.exports.createElement(k,null,e.exports.createElement("label",{htmlFor:"comment"}," Edit Comment"),e.exports.createElement("textarea",{name:"comment",onChange:d,onBlur:n,value:c.comment}),o.comment&&e.exports.createElement("div",{className:_.error},o.comment),e.exports.createElement("button",{className:"btn",type:"submit",disabled:s},"Comment"))))}function K(t){const s=g(a=>a.user.token),u=g(a=>a.user.id)===t.comment.user._id,[m,r]=e.exports.useState(!1);function o(a){return(a==null?void 0:a.charAt(0).toUpperCase())+(a==null?void 0:a.slice(1).toLowerCase())}const n=()=>{r(a=>!a)},d=async()=>{try{if(!(await fetch(`https://aryan-api.771727.xyz/blog-mania/blogs/comment/${t.comment._id}`,{method:"DELETE",headers:{authorization:`BEARER ${s}`}})).ok)throw new Error("Could not delete comment");t.toggler()}catch(a){console.log(a)}},c=new Date(t.comment.date).toLocaleString();return e.exports.createElement("div",{className:E.item},e.exports.createElement("div",{className:E.user},e.exports.createElement("img",{src:Y,alt:"Icon"}),e.exports.createElement("h3",null,o(t.comment.user.firstName)+" "+o(t.comment.user.lastName)+" ",e.exports.createElement("span",{className:E.span},c),e.exports.createElement("span",null,u&&e.exports.createElement(e.exports.Fragment,null,e.exports.createElement(C,{size:"20px",color:"grey",className:E.icon,onClick:n}),e.exports.createElement(w,{size:"20px",color:"grey",className:E.icon,onClick:d}))))),m?e.exports.createElement(Q,{commentId:t.comment._id,comment:t.comment.content,toggler:t.toggler,editToggle:n}):e.exports.createElement("p",null,t.comment.content))}const X="_comments_ikvyj_1",Z="_container_ikvyj_19",ee="_active_ikvyj_64",te="_previous_ikvyj_73",oe="_next_ikvyj_74",ne="_disabled_ikvyj_105";var p={comments:X,container:Z,active:ee,previous:te,next:oe,disabled:ne};function ae(t){const{comments:s}=t,l=g(i=>i.user.token),[u,m]=e.exports.useState(0),r=5,o=u*r,n=e.exports.useMemo(()=>!s||!s.length?[]:[...s].sort((i,x)=>new Date(x.date)-new Date(i.date)),[s]),d=n!=null&&n.length?n.length:1,c=Math.ceil(d/r),a=({selected:i})=>{m(i)};return e.exports.createElement("div",{className:p.comments},e.exports.createElement("h2",null,"Comments"),l?e.exports.createElement(q,{blogId:t.blogId,toggler:t.toggler}):e.exports.createElement("h3",null,"Login to comment"),n&&n.length>0&&e.exports.createElement(e.exports.Fragment,null,n.slice(o,o+r).map(i=>e.exports.createElement(K,{comment:i,key:i._id,toggler:t.toggler})),e.exports.createElement(L,{previousLabel:e.exports.createElement("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round"},e.exports.createElement("path",{d:"M15 18l-6-6 6-6"})),nextLabel:e.exports.createElement("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round"},e.exports.createElement("path",{d:"M9 18l6-6-6-6"})),pageCount:c,onPageChange:a,containerClassName:p.container,previousClassName:p.previous,nextClassName:p.next,previousLinkClassName:p.btn,nextLinkClassName:p.btn,activeClassName:p.active})))}const le=()=>{const t=z(),{id:s}=t,l=g(x=>x.user),[u,m]=e.exports.useState(!1),r=()=>{m(x=>!x)},{data:o,error:n,isLoading:d}=$(["blog-data",s],()=>F(s)),c=o?o.blog:null,a=e.exports.createElement("div",{className:h.buttons},e.exports.createElement(S,{to:`/edit/${s}`},e.exports.createElement(C,{className:h.icon,size:"30px"})),e.exports.createElement(H,{id:s}));let i=!1;return!!l.token&&c&&(i=c.author._id===l.id),n?e.exports.createElement("div",{className:h.message},e.exports.createElement("h1",{className:h.error},n.message)):e.exports.createElement(e.exports.Fragment,null,d?e.exports.createElement(B,null):e.exports.createElement(e.exports.Fragment,null,e.exports.createElement("div",{className:h.blog},e.exports.createElement("h1",null,c.title),e.exports.createElement("h2",null,c.author.firstName+" "+c.author.lastName," "),e.exports.createElement("h3",null,c.description),i&&a,e.exports.createElement("p",null,c.article)),e.exports.createElement(ae,{blogId:s,comments:c.comments,toggler:r})))};export{le as default};
